<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AgroDetect AI Assistant</title>

<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
  font-family:'Roboto',sans-serif;
  background:linear-gradient(to right,#a8e063,#56ab2f);
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}
.container{
  background:#fff;
  padding:25px;
  border-radius:15px;
  width:100%;
  max-width:750px;
  box-shadow:0 8px 25px rgba(0,0,0,0.2);
}
h1{text-align:center;margin-bottom:20px}
label{font-weight:500;margin-top:10px;display:block}
input,select,button{
  width:100%;
  padding:12px;
  margin-top:10px;
  border-radius:8px;
  border:1px solid #ccc;
}
button{
  background:#56ab2f;
  color:white;
  font-weight:600;
  cursor:pointer;
}
button:hover{background:#3e8e1a}
#resetBtn{background:#f44336}
#stopSpeakerBtn{background:#ff9800}
#imagePreview{
  display:none;
  max-width:100%;
  margin-top:15px;
  border-radius:10px;
}
.disease-card{
  background:#f9f9f9;
  padding:15px;
  border-radius:12px;
  margin-bottom:15px;
  box-shadow:0 4px 10px rgba(0,0,0,0.1);
}
.section-title{font-weight:600;margin-top:8px}
</style>
</head>

<body>
<div class="container">
<h1>üå± AgroDetect AI Assistant</h1>

<label>Upload Leaf Image</label>
<input type="file" id="leafImage" accept="image/*">
<img id="imagePreview">

<label>Select Language</label>
<select id="language">
  <option>English</option>
  <option>Hindi</option>
  <option>Telugu</option>
</select>

<label><input type="checkbox" id="enableSpeaker" checked> Enable Speaker</label>

<button onclick="showDiseases()">Get Disease Info</button>
<button onclick="speakAll()">üîä Speak All</button>
<button id="stopSpeakerBtn" onclick="stopSpeech()">‚èπ Stop</button>
<button id="resetBtn" onclick="resetAll()">Reset</button>

<div id="output"></div>
</div>

<script>
const leafImage=document.getElementById("leafImage");
const imagePreview=document.getElementById("imagePreview");
const output=document.getElementById("output");
const language=document.getElementById("language");
const enableSpeaker=document.getElementById("enableSpeaker");
let currentSpeech=null;

// Image preview
leafImage.onchange=()=>{
  const file=leafImage.files[0];
  if(file){
    const reader=new FileReader();
    reader.onload=e=>{
      imagePreview.src=e.target.result;
      imagePreview.style.display="block";
    };
    reader.readAsDataURL(file);
  }
};

// Disease database
function getDiseases(lang,fileName){
let data={
English:[
{d:"Powdery Mildew",s:"White powder on leaves.",t:"Spray fungicide.",p:"Avoid overhead watering."},
{d:"Leaf Spot",s:"Brown or black spots.",t:"Use copper fungicide.",p:"Remove infected leaves."},
{d:"Rust Disease",s:"Orange rust spots.",t:"Sulfur fungicide.",p:"Improve air flow."},
{d:"Bacterial Blight",s:"Water soaked lesions.",t:"Antibacterial spray.",p:"Avoid wet leaves."},
{d:"Early Blight",s:"Dark concentric rings.",t:"Neem oil or fungicide.",p:"Crop rotation."},
{d:"Healthy Leaf",s:"No disease signs.",t:"No treatment needed.",p:"Maintain proper care."}
],
Hindi:[
{d:"‡§™‡§æ‡§â‡§°‡§∞‡•Ä ‡§Æ‡§ø‡§≤‡•ç‡§°‡•ç‡§Ø‡•Ç",s:"‡§∏‡§´‡•á‡§¶ ‡§™‡§æ‡§â‡§°‡§∞ ‡§ú‡•à‡§∏‡•á ‡§ß‡§¨‡•ç‡§¨‡•á‡•§",t:"‡§´‡§Ç‡§ó‡§ø‡§∏‡§æ‡§á‡§° ‡§õ‡§ø‡§°‡§º‡§ï‡•á‡§Ç‡•§",p:"‡§ä‡§™‡§∞ ‡§∏‡•á ‡§™‡§æ‡§®‡•Ä ‡§® ‡§°‡§æ‡§≤‡•á‡§Ç‡•§"},
{d:"‡§≤‡•Ä‡§´ ‡§∏‡•ç‡§™‡•â‡§ü",s:"‡§≠‡•Ç‡§∞‡•á/‡§ï‡§æ‡§≤‡•á ‡§ß‡§¨‡•ç‡§¨‡•á‡•§",t:"‡§ï‡•â‡§™‡§∞ ‡§´‡§Ç‡§ó‡§ø‡§∏‡§æ‡§á‡§°‡•§",p:"‡§∏‡§Ç‡§ï‡•ç‡§∞‡§Æ‡§ø‡§§ ‡§™‡§§‡•ç‡§§‡•á ‡§π‡§ü‡§æ‡§è‡§Ç‡•§"},
{d:"‡§∞‡§∏‡•ç‡§ü ‡§∞‡•ã‡§ó",s:"‡§®‡§æ‡§∞‡§Ç‡§ó‡•Ä ‡§ú‡§Ç‡§ó ‡§ú‡•à‡§∏‡•á ‡§ß‡§¨‡•ç‡§¨‡•á‡•§",t:"‡§∏‡§≤‡•ç‡§´‡§∞ ‡§´‡§Ç‡§ó‡§ø‡§∏‡§æ‡§á‡§°‡•§",p:"‡§π‡§µ‡§æ ‡§ï‡§æ ‡§∏‡§Ç‡§ö‡§æ‡§∞ ‡§¨‡§¢‡§º‡§æ‡§è‡§Ç‡•§"},
{d:"‡§∏‡•ç‡§µ‡§∏‡•ç‡§• ‡§™‡§§‡•ç‡§§‡§æ",s:"‡§ï‡•ã‡§à ‡§∞‡•ã‡§ó ‡§®‡§π‡•Ä‡§Ç‡•§",t:"‡§â‡§™‡§ö‡§æ‡§∞ ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§®‡§π‡•Ä‡§Ç‡•§",p:"‡§®‡§ø‡§Ø‡§Æ‡§ø‡§§ ‡§¶‡•á‡§ñ‡§≠‡§æ‡§≤‡•§"}
],
Telugu:[
{d:"‡∞™‡±å‡∞°‡∞∞‡±Ä ‡∞Æ‡∞ø‡∞≤‡±ç‡∞°‡±ç‡∞Ø‡±Ç",s:"‡∞§‡±Ü‡∞≤‡±ç‡∞≤‡∞ü‡∞ø ‡∞™‡±ä‡∞°‡∞ø ‡∞Æ‡∞ö‡±ç‡∞ö‡∞≤‡±Å.",t:"‡∞´‡∞Ç‡∞ó‡∞ø‡∞∏‡±à‡∞°‡±ç ‡∞µ‡∞æ‡∞°‡∞Ç‡∞°‡∞ø.",p:"‡∞™‡±à ‡∞®‡±Å‡∞Ç‡∞°‡∞ø ‡∞®‡±Ä‡∞∞‡±Å ‡∞™‡±ã‡∞Ø‡∞µ‡∞¶‡±ç‡∞¶‡±Å."},
{d:"‡∞≤‡±Ä‡∞´‡±ç ‡∞∏‡±ç‡∞™‡∞æ‡∞ü‡±ç",s:"‡∞ó‡±ã‡∞ß‡±Å‡∞Æ/‡∞®‡∞≤‡±ç‡∞≤ ‡∞Æ‡∞ö‡±ç‡∞ö‡∞≤‡±Å.",t:"‡∞ï‡∞æ‡∞™‡∞∞‡±ç ‡∞´‡∞Ç‡∞ó‡∞ø‡∞∏‡±à‡∞°‡±ç.",p:"‡∞¨‡∞æ‡∞ß‡∞ø‡∞§ ‡∞Ü‡∞ï‡±Å‡∞≤‡±Å ‡∞§‡±ä‡∞≤‡∞ó‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø."},
{d:"‡∞∞‡∞∏‡±ç‡∞ü‡±ç ‡∞µ‡±ç‡∞Ø‡∞æ‡∞ß‡∞ø",s:"‡∞®‡∞æ‡∞∞‡∞ø‡∞Ç‡∞ú ‡∞∞‡∞Ç‡∞ó‡±Å ‡∞Æ‡∞ö‡±ç‡∞ö‡∞≤‡±Å.",t:"‡∞∏‡∞≤‡±ç‡∞´‡∞∞‡±ç ‡∞´‡∞Ç‡∞ó‡∞ø‡∞∏‡±à‡∞°‡±ç.",p:"‡∞ó‡∞æ‡∞≤‡∞ø ‡∞™‡±ç‡∞∞‡∞µ‡∞æ‡∞π‡∞Ç ‡∞™‡±Ü‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø."},
{d:"‡∞Ü‡∞∞‡±ã‡∞ó‡±ç‡∞Ø‡∞Æ‡±à‡∞® ‡∞Ü‡∞ï‡±Å",s:"‡∞é‡∞ü‡±Å‡∞µ‡∞Ç‡∞ü‡∞ø ‡∞µ‡±ç‡∞Ø‡∞æ‡∞ß‡∞ø ‡∞≤‡±á‡∞¶‡±Å.",t:"‡∞ö‡∞ø‡∞ï‡∞ø‡∞§‡±ç‡∞∏ ‡∞Ö‡∞µ‡∞∏‡∞∞‡∞Ç ‡∞≤‡±á‡∞¶‡±Å.",p:"‡∞∏‡∞∞‡±à‡∞® ‡∞∏‡∞Ç‡∞∞‡∞ï‡±ç‡∞∑‡∞£."}
]
};

let list=data[lang];

// simple image-name logic
if(fileName.includes("healthy")) return [list[list.length-1]];
if(fileName.includes("rust")) return list.filter(x=>x.d.includes("Rust")||x.d.includes("‡∞∞‡∞∏‡±ç‡∞ü‡±ç")||x.d.includes("‡§∞‡§∏‡•ç‡§ü"));

return list;
}

// Show diseases
function showDiseases(){
async function showDiseases() {
  if (!leafImage.files[0]) { alert("Upload leaf image first"); return; }
  output.innerHTML = "Detecting...";

  const formData = new FormData();
  formData.append("leaf", leafImage.files[0]);
  formData.append("language", language.value);

  try {
    const res = await fetch("http://localhost:5000/detect", {
      method: "POST",
      body: formData
    });
    const data = await res.json();
    output.innerHTML = "";
    data.diseases.forEach(x => {
      output.innerHTML += `
        <div class="disease-card">
          <h3>${x.d}</h3>
          <p class="section-title">Symptoms:</p><p>${x.s}</p>
          <p class="section-title">Treatment:</p><p>${x.t}</p>
          <p class="section-title">Precautions:</p><p>${x.p}</p>
        </div>`;
    });
  } catch (err) {
    output.innerHTML = "Error detecting disease!";
    console.error(err);
  }
}
}

// Speaker
function speakAll(){
if(!enableSpeaker.checked||output.innerText===""){alert("Nothing to speak");return;}
speechSynthesis.cancel();
currentSpeech=new SpeechSynthesisUtterance(output.innerText);
speechSynthesis.speak(currentSpeech);
}

// Stop
function stopSpeech(){
speechSynthesis.cancel();
currentSpeech=null;
}

// Reset
function resetAll(){
leafImage.value="";
imagePreview.style.display="none";
output.innerHTML="";
language.value="English";
speechSynthesis.cancel();
}
</script>
</body>
</html>